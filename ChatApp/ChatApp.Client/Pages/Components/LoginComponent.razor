@using Shared.Models
@using MudBlazor
@inject NavigationManager navManager
@rendermode InteractiveWebAssembly

<MudGrid Style="height: 100vh; display: flex; justify-content: center; align-items: center;">
    <MudItem xs="12" sm="12" md="8" lg="6" xl="4">
        <MudPaper Elevation="4" Style="padding: 2rem; background-color: #ffffff; border-radius: 8px; max-width: 100%; width: 100%;">
            <MudText Typo="Typo.h6" Style="text-align: center; margin-bottom: 1.5rem; font-weight: bold; color: #333;">Login</MudText>
            <MudForm Style="display: flex; flex-direction: column;">
                <MudTextField T="string" 
                              @bind-Value="UserName" 
                              Variant="Variant.Filled" 
                              Label="Enter your name"
                              Style="margin-bottom: 1rem; width: 100%;" />
                <MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="SignIn" Style="width: 100%; border-radius: 8px; padding: 0.75rem; font-size: 1.1rem;">Sign In</MudButton>
            </MudForm>
        </MudPaper>
    </MudItem>
</MudGrid>



@code {
    public string UserName { get; set; }


    public async Task SignIn()
    {
        if (string.IsNullOrWhiteSpace(UserName))
        {
            return;
        }

        var httpClient = new HttpClient();
        var user = await httpClient.GetFromJsonAsync<User>("https://localhost:7121/api/user?username=" + UserName);
        if (user != null)
            navManager.NavigateTo($"/chat/{user.UserName}");

    }
}
